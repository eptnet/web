<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor de Microsite del Proyecto</title>
    
    <link rel="icon" type="image/png" href="https://i.ibb.co/hFRyKrxY/logo-epist-v3-1x1-c.png">
    <link rel="stylesheet" href="/inv/css/style-editor.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.tiny.cloud/1/wac03ii8izevsozn0if0ssfme0syw62i0zw7szp05f8trx3o/tinymce/6/tinymce.min.js" referrerpolicy="origin"></script>
</head>
<body>

    <header class="editor-main-header">
        <a href="/inv/dashboard.html" class="header-logo">
            <img src="https://i.ibb.co/hFRyKrxY/logo-epist-v3-1x1-c.png" alt="Logo">
            <span>Editor de Microsite</span>
        </a>
        <nav class="header-nav">
            <a href="/inv/dashboard.html"><i class="fa-solid fa-table-columns"></i> Dashboard</a>
            <a href="/inv/profile.html"><i class="fa-solid fa-user"></i> Mi Perfil</a>
        </nav>
    </header>

    <div class="editor-container">
        <div class="editor-panel">
            <header class="editor-header">
                <h1>Editor del Microsite</h1>
                <p>Construye la página pública de tu proyecto.</p>
            </header>

            <form id="microsite-form">
                
                <fieldset>
                    <legend><i class="fa-solid fa-image"></i> Portada</legend>
                    <label for="cover-headline">Titular Principal:</label>
                    <div class="input-with-ai">
                        <input type="text" id="cover-headline" name="cover-headline" placeholder="Un titular breve y potente...">
                        <button type="button" class="ai-button" data-target="cover-headline" data-prompt="generate_microsite_headline" title="Generar con IA">✨</button>
                    </div>
                    
                    <label for="cover-image-url">URL de Imagen de Fondo:</label>
                    <input type="text" id="cover-image-url" name="cover-image-url" placeholder="https://ejemplo.com/imagen.jpg">

                    <label for="seo-image-url">URL de Miniatura para Redes (SEO):</label>
                    <p class="form-hint">Esta imagen se mostrará cuando compartas el enlace. Si lo dejas en blanco, se usará la imagen de fondo.</p>
                    <input type="text" id="seo-image-url" name="seo-image-url" placeholder="URL de imagen cuadrada o 1200x630px">
                </fieldset>

                <fieldset>
                    <legend><i class="fa-solid fa-bullseye"></i> Resumen / El Problema</legend>
                    <label for="summary-content">Contenido del Resumen:</label>
                    <div class="input-with-ai">
                        <textarea id="summary-content" name="summary-content" class="tinymce-editor" placeholder="Explica tu proyecto de forma sencilla..."></textarea>
                        <button type="button" class="ai-button ai-button-textarea" data-target="summary-content" data-prompt="generate_accessible_summary" title="Reformular con IA">✨</button>
                    </div>
                </fieldset>

                <fieldset>
                    <legend><i class="fa-solid fa-users"></i> Equipo de Investigadores</legend>
                    <p class="form-hint">Esta sección se llena automáticamente con los autores de tu proyecto. Los perfiles con cuenta en la plataforma se mostrarán con más detalle.</p>
                    <div id="researchers-preview-container" class="preview-grid">
                        <p>Cargando investigadores...</p>
                    </div>
                </fieldset>

                <fieldset>
                    <legend><i class="fa-solid fa-podcast"></i> Eventos y Sesiones</legend>
                    <p class="form-hint">Aquí aparecerán todas las sesiones de divulgación asociadas a este proyecto.</p>
                    <div id="sessions-preview-container" class="preview-grid">
                        <p>Cargando sesiones...</p>
                    </div>
                </fieldset>

                <fieldset>
                    <legend><i class="fa-solid fa-file-alt"></i> Artículos y Publicaciones</legend>
                    <p class="form-hint">Aquí aparecerán todos los posts y borradores asociados a este proyecto.</p>
                    <div id="posts-preview-container" class="preview-grid">
                        <p>Cargando publicaciones...</p>
                    </div>
                </fieldset>

                <fieldset>
                    <legend><i class="fa-solid fa-layer-group"></i> Módulos de Contenido</legend>
                    <p class="form-hint">Para video YouTube, pegar solo el url, para otras plataformas incrustar usar SOLO el link de incrustar no el código ni el link directo.</p>
                    <div id="custom-modules-container">
                        </div>
                    <div class="module-actions">
                        <button type="button" id="add-text-module-btn"><i class="fa-solid fa-plus"></i> Añadir Módulo de Texto</button>
                        <button type="button" id="add-embed-module-btn"><i class="fa-solid fa-plus"></i> Añadir Módulo de Enlace/Embed</button>
                        <button type="button" id="add-subscription-module-btn"><i class="fa-solid fa-envelope-open-text"></i> Añadir Módulo de Suscripción</button>
                        <button type="button" id="add-sponsors-module-btn"><i class="fa-solid fa-handshake-angle"></i> Añadir Módulo de Patrocinadores</button>
                        <button type="button" id="add-timeline-module-btn"><i class="fa-solid fa-stream"></i> Añadir Módulo de Timeline</button>
                    </div>
                </fieldset>

                <fieldset>
                    <legend><i class="fa-solid fa-palette"></i> Diseño y Plantilla</legend>
                    <div class="design-selectors">
                        <div class="form-group">
                            <label for="template-style-select">Estilo de Plantilla</label>
                            <select id="template-style-select">
                                <option value="classic">Clásica (Contenido centrado)</option>
                                <option value="modern">Moderna (Ancho completo)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="color-palette-select">Paleta de Colores</label>
                            <select id="color-palette-select">
                                <option value="default">Claro (Por defecto)</option>
                                <option value="dark">Oscuro</option>
                                <option value="sand">Arena</option>
                            </select>
                        </div>
                    </div>
                </fieldset>

                <fieldset>
                    <legend><i class="fa-solid fa-globe"></i> Estado de Publicación</legend>
                    <div class="publish-toggle">
                        <label for="microsite-is-public">Hacer microsite público</label>
                        <p class="form-hint">Cuando esté activo, cualquiera con el enlace podrá ver la página.</p>
                        <label class="switch">
                            <input type="checkbox" id="microsite-is-public" name="microsite-is-public">
                            <span class="slider round"></span>
                        </label>
                    </div>
                </fieldset>

                <div class="final-actions">
                    <button type="button" id="preview-btn" class="secondary-button"><i class="fa-solid fa-eye"></i> Vista Previa</button>
                    <button type="submit" id="save-btn"><i class="fa-solid fa-save"></i> Guardar Cambios</button>
                </div>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="/inv/js/microsite-editor.js"></script>
</body>
</html>