<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estudio Omnicanal - Epistecnolog√≠a</title>
    <link rel="icon" type="image/png" href="https://i.ibb.co/hFRyKrxY/logo-epist-v3-1x1-c.png">
    
    <link rel="stylesheet" href="/inv/css/dashboard.css">
    <link rel="stylesheet" href="/inv/css/editor.css"> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
    
    <script src="https://cdn.tiny.cloud/1/wac03ii8izevsozn0if0ssfme0syw62i0zw7szp05f8trx3o/tinymce/7/tinymce.min.js" referrerpolicy="origin"></script>
</head>
<body class="studio-body">
    <header class="studio-topbar">
        <div class="topbar-left">
            <a href="/inv/dashboard.html" class="back-btn" title="Volver al Dashboard"><i class="fa-solid fa-arrow-left"></i></a>
            <img src="https://i.ibb.co/hFRyKrxY/logo-epist-v3-1x1-c.png" alt="Logo" class="studio-logo">
            
            <div class="project-focus-selector">
                <label for="active-project-select"><i class="fa-solid fa-microscope"></i> Proyecto Activo:</label>
                <select id="active-project-select" class="form-control">
                    <option value="">Cargando proyectos...</option>
                </select>
                <span id="doi-badge" class="badge-hidden" title="Proyecto verificado con DOI"><i class="fa-solid fa-certificate"></i> DOI Verificado</span>
            </div>
        </div>

        <div class="topbar-right">
            <span id="save-status" class="save-status"><i class="fa-solid fa-cloud"></i> Guardado autom√°tico</span>
            <button class="icon-btn" id="theme-switcher-studio" title="Cambiar tema"><i class="fa-solid fa-moon"></i></button>
            <button class="icon-btn logout-btn" id="logout-btn" title="Cerrar Sesi√≥n"><i class="fa-solid fa-right-from-bracket"></i></button>
        </div>
    </header>

    <main class="studio-workspace">
        
        <aside class="col-ai-engine pane">
            <div class="pane-header">
                <h2><i class="fa-solid fa-brain"></i> Asistente de Creaci√≥n</h2>
            </div>
            
            <div class="ai-tabs">
                <button class="ai-tab-btn active" data-target="tab-text"><i class="fa-solid fa-pen-nib"></i> Texto</button>
                <button class="ai-tab-btn" data-target="tab-image"><i class="fa-solid fa-image"></i> Imagen</button>
                <button class="ai-tab-btn disabled" data-target="tab-video" title="Pr√≥ximamente"><i class="fa-solid fa-film"></i> Video</button>
            </div>

            <div class="ai-tab-content active" id="tab-text">
                <div class="form-group">
                    <label>¬øQu√© necesitas redactar?</label>
                    <select id="ai-task-dropdown" class="form-control">
                        <option value="social">Hilo para Redes Sociales</option>
                        <option value="summary">Resumen (Abstract)</option>
                        <option value="text">Art√≠culo de Divulgaci√≥n</option>
                        <option value="script">Guion para Video Corto</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Instrucciones adicionales (Opcional):</label>
                    <textarea id="ai-custom-prompt" rows="4" placeholder="Ej: Usa un tono ir√≥nico, enf√≥cate en los resultados del a√±o 2023..."></textarea>
                </div>
                <button id="ai-generate-text-btn" class="btn-primary w-100"><i class="fa-solid fa-wand-magic-sparkles"></i> Generar Texto</button>
                <div id="ai-text-results" class="ai-results-container"></div>
            </div>

            <div class="ai-tab-content" id="tab-image">
                <div class="form-group">
                    <label>¬øQu√© deseas pintar?</label>
                    <textarea id="ai-image-prompt" class="form-control" rows="3" placeholder="Ej: Un libro antiguo brillante rodeado de hologramas de ADN..."></textarea>
                </div>
                <div class="form-group-row" style="display: flex; gap: 10px; margin-bottom: 15px;">
                    <div style="flex: 1;">
                        <label>Estilo Visual</label>
                        <select id="ai-image-style" class="form-control">
                            <option value="editorial">üé® Editorial EPT (Pintura Cl√°sica)</option>
                            <option value="realistic">üì∏ Realista / Fotogr√°fico</option>
                            <option value="vector">üñãÔ∏è Vector / Infograf√≠a</option>
                            <option value="cinematic">üé¨ Cinem√°tico / Pel√≠cula</option>
                        </select>
                    </div>
                    <div style="flex: 1;">
                        <label>Formato</label>
                        <select id="ai-image-ratio" class="form-control">
                            <option value="16:9">Horizontal (16:9)</option>
                            <option value="1:1">Cuadrado (1:1)</option>
                            <option value="9:16">Vertical (9:16)</option>
                        </select>
                    </div>
                </div>
                <button id="ai-generate-image-btn" class="btn-primary w-100"><i class="fa-solid fa-palette"></i> Pintar Imagen</button>
                <div id="ai-image-results"></div>

                <div id="lightbox-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:9999; justify-content:center; align-items:center; flex-direction:column;">
                    <span onclick="document.getElementById('lightbox-modal').style.display='none'" style="position:absolute; top:20px; right:30px; color:white; font-size:40px; cursor:pointer;">&times;</span>
                    <img id="lightbox-img" src="" style="max-width:90%; max-height:70%; border-radius:8px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); margin-bottom: 20px;">
                    
                    <div style="display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;">
                        <button onclick="StudioApp.downloadLocalImage()" class="btn-secondary"><i class="fa-solid fa-download"></i> Guardar en mi PC</button>
                        <button id="upload-imgbb-btn" onclick="StudioApp.uploadToImgBB()" class="btn-primary"><i class="fa-solid fa-cloud-arrow-up"></i> Usar en el Art√≠culo (Subir a la nube)</button>
                    </div>
                </div>
            </div>
        </aside>

        <section class="col-editor pane">
            <div class="pane-header">
                <input type="text" id="post-title" class="editor-title-input" placeholder="Escribe un t√≠tulo atractivo para tu art√≠culo...">
            </div>
            
            <div class="editor-container">
                <textarea id="rich-text-editor"></textarea>
            </div>

            <div class="media-tray">
                <h4><i class="fa-solid fa-paperclip"></i> Archivos Adjuntos</h4>
                <div id="media-gallery" class="media-gallery">
                    <p class="empty-tray-text">Las im√°genes generadas aparecer√°n aqu√≠.</p>
                </div>
            </div>
        </section>

        <aside class="col-distribution pane">
            <div class="pane-header">
                <h2><i class="fa-solid fa-share-nodes"></i> Distribuci√≥n</h2>
            </div>

            <div class="distribution-section">
                <h3>1. Selecciona los destinos</h3>
                <div class="network-toggles">
                    <label class="network-toggle">
                        <input type="checkbox" id="dest-epistecnologia" checked disabled> <span class="network-icon epist-bg"><i class="fa-solid fa-microscope"></i></span> Comunidad Epistecnolog√≠a
                    </label>
                    <label class="network-toggle">
                        <input type="checkbox" id="dest-bsky">
                        <span class="network-icon bsky-bg"><i class="fa-brands fa-bluesky"></i></span> Bluesky
                    </label>
                    <label class="network-toggle" title="Pr√≥ximamente">
                        <input type="checkbox" id="dest-linkedin" disabled>
                        <span class="network-icon linkedin-bg"><i class="fa-brands fa-linkedin-in"></i></span> LinkedIn
                    </label>
                </div>
            </div>

            <div class="distribution-section">
                <h3>2. Adapta tu mensaje (Redes Sociales)</h3>
                <p class="help-text">Este texto acompa√±ar√° al enlace de tu art√≠culo principal.</p>
                <textarea id="social-post-text" rows="5" placeholder="¬°He publicado un nuevo avance sobre mi investigaci√≥n! Lee los detalles aqu√≠..."></textarea>
                <div class="char-counter">
                    <span id="social-char-count">0</span> / <span id="social-char-limit">300</span>
                </div>
            </div>

            <div class="distribution-section">
                <h3>3. Enlace de la Publicaci√≥n</h3>
                <p class="help-text">Confirma el enlace (DOI o Perfil) que acompa√±ar√° al post en redes.</p>
                <div class="form-group">
                    <input type="text" id="social-post-link" class="form-control" placeholder="https://doi.org/...">
                </div>
            </div>

            <div class="distribution-actions">
                <button id="save-draft-btn" class="btn-secondary w-100 mb-2"><i class="fa-regular fa-floppy-disk"></i> Guardar Borrador</button>
                <button id="publish-btn" class="btn-publish w-100"><i class="fa-solid fa-paper-plane"></i> Publicar Ahora</button>
                
                <p class="publish-disclaimer">
                    <i class="fa-solid fa-envelope"></i> Al publicar, se enviar√° una copia al Editor en Jefe para su posible inclusi√≥n en la revista oficial.
                </p>
            </div>
        </aside>

    </main>

    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script type="module" src="/inv/js/editor.js"></script>
</body>
</html>