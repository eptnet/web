<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Prueba de Composición con Canvas</title>
    <style>
        body { font-family: sans-serif; background-color: #222; color: #fff; padding: 20px; }
        .video-sources, .canvas-output { margin-bottom: 20px; }
        video, canvas { border: 2px solid #555; border-radius: 8px; }
        video { width: 320px; height: 180px; }
        canvas { width: 1280px; height: 720px; background-color: #000; }
        button { font-size: 1.2rem; padding: 10px 20px; cursor: pointer; }
    </style>
</head>
<body>

    <h1>Prueba de Composición de Video</h1>

    <div class="video-sources">
        <h2>Fuentes de Video (Simuladas)</h2>
        <video id="source1" src="http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4" crossorigin="anonymous" muted loop playsinline></video>
        <video id="source2" src="http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4" crossorigin="anonymous" muted loop playsinline></video>
    </div>

    <button id="startButton">Iniciar Composición</button>

    <div class="canvas-output">
        <h2>Salida Compuesta en Canvas (1280x720)</h2>
        <canvas id="compositionCanvas" width="1280" height="720"></canvas>
    </div>

    <script>
        document.getElementById('startButton').addEventListener('click', () => {
            const video1 = document.getElementById('source1');
            const video2 = document.getElementById('source2');
            const canvas = document.getElementById('compositionCanvas');
            const ctx = canvas.getContext('2d');

            // Inicia la reproducción de los videos de origen (en silencio)
            video1.play();
            video2.play();

            console.log("Iniciando bucle de dibujo...");

            // Creamos una función que se ejecute en cada frame
            function drawLoop() {
                // Dibujamos el video 1 en el canvas
                // ctx.drawImage(fuente, x, y, ancho, alto);
                ctx.drawImage(video1, 0, 0, 640, 720); // Video 1 a la izquierda, llenando la mitad del alto

                // Dibujamos el video 2 en el canvas
                ctx.drawImage(video2, 640, 0, 640, 720); // Video 2 a la derecha, llenando la mitad del alto
                
                // Le pedimos al navegador que vuelva a llamar a esta función en el próximo frame
                requestAnimationFrame(drawLoop);
            }

            // Iniciamos el bucle
            drawLoop();
        });
    </script>

</body>
</html>